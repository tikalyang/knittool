<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é‰¤é‡ç¹”åœ–å…¨èƒ½ç”Ÿæˆå™¨ - AI å”ä½œå°ˆæ¥­ç‰ˆ</title>
    <style>
        body { font-family: -apple-system, sans-serif; background-color: #fdf2f2; color: #4a4a4a; padding: 20px; display: flex; flex-direction: column; align-items: center; line-height: 1.5; }
        .container { background: white; padding: 25px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); max-width: 600px; width: 100%; }
        h2 { color: #d63384; text-align: center; margin-bottom: 5px; }
        .author { text-align: center; font-size: 12px; color: #aaa; margin-bottom: 20px; }
        
        /* æ•™å­¸å€å¡Š */
        .ai-guide { background-color: #f0f7ff; border: 1px solid #cce5ff; border-radius: 10px; padding: 15px; margin-bottom: 20px; }
        .prompt-box { background: white; border: 1px solid #b8daff; padding: 10px; border-radius: 5px; font-family: monospace; font-size: 13px; margin: 10px 0; }
        .copy-btn { background: #007bff; color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 12px; }

        /* é‡æ³•å°ç…§èªªæ˜å€ */
        .legend-card { background: #fffafb; border: 2px solid #f8d7da; border-radius: 10px; padding: 15px; margin-bottom: 20px; }
        .legend-title { font-weight: bold; color: #d63384; margin-bottom: 10px; display: block; border-bottom: 1px solid #f8d7da; }
        .legend-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 14px; }
        .code-tag { background: #d63384; color: white; padding: 2px 6px; border-radius: 4px; font-weight: bold; font-family: monospace; margin-right: 5px; }

        .input-group { display: flex; flex-direction: column; gap: 12px; border-top: 1px solid #eee; pt: 20px; }
        .row { display: flex; gap: 10px; align-items: center; flex-wrap: wrap; }
        .row label { flex: 1; min-width: 100px; font-weight: bold; font-size: 14px; }
        input, select { flex: 2; padding: 10px; border: 1px solid #ddd; border-radius: 8px; }
        
        .checkbox-row { display: flex; align-items: center; gap: 10px; background: #fff9fa; padding: 10px; border-radius: 8px; }
        .btn-generate { background-color: #d63384; color: white; border: none; padding: 15px; border-radius: 8px; cursor: pointer; font-size: 18px; font-weight: bold; margin-top: 10px; }
        .btn-generate:hover { background-color: #b02a6b; }

        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #f8d7da; padding: 10px; text-align: center; }
        th { background-color: #fff0f3; color: #d63384; }
        .notice { background: #fff3cd; padding: 15px; border-radius: 8px; margin-top: 15px; font-size: 14px; border-left: 5px solid #ffc107; }
    </style>
</head>
<body>

<div class="container">
    <h2>ğŸ§¶ é‰¤é‡ç¹”åœ–å…¨èƒ½ç”Ÿæˆå™¨</h2>
    <p class="author">AI å”ä½œ x è‡ªå‹•è¨ˆç®— x ç¸«åˆé ç•™</p>

    <div class="legend-card">
        <span class="legend-title">ğŸ“ é‡æ³•ä»£è™Ÿèªªæ˜ (Stitch Legend)</span>
        <div class="legend-grid">
            <div><span class="code-tag">X</span> çŸ­é‡ (Single Crochet)</div>
            <div><span class="code-tag">V</span> åŠ é‡ (Increase)</div>
            <div><span class="code-tag">A</span> æ¸›é‡ (Decrease)</div>
            <div><span class="code-tag">MR</span> ç’°ç‹€èµ·é‡ (Magic Ring)</div>
        </div>
    </div>

    <div class="ai-guide">
        <h3 style="margin-top:0; font-size:16px;">ğŸ¤– ç¬¬ä¸€æ­¥ï¼šè«®è©¢ AI åŠ©ç†</h3>
        <p style="font-size: 13px;">å°‡è¨­è¨ˆåœ–å‚³çµ¦ AI ä¸¦è²¼ä¸Šï¼š</p>
        <div class="prompt-box" id="pBox">è«‹åˆ†æé€™å¼µè¨­è¨ˆåœ–å„éƒ¨ä½ã€‚å‘Šè¨´æˆ‘æ¯å€‹éƒ¨ä½æ˜¯ã€çƒé«”/é•·æ©¢åœ“/æ°´æ»´ç‹€ã€‘ï¼Œä¸¦ä¼°è¨ˆå…¶ã€æœ€å¤§ç›´å¾‘(cm)ã€‘èˆ‡ã€ç¸½é•·åº¦(cm)ã€‘ã€‚</div>
        <button class="copy-btn" onclick="copyP()">ä¸€éµè¤‡è£½é—œéµå­—</button>
    </div>

    <div class="input-group">
        <div class="row">
            <label>éƒ¨ä½å½¢ç‹€:</label>
            <select id="shape">
                <option value="normal">æ¨™æº–çƒé«” / é•·æ©¢åœ“</option>
                <option value="teardrop">æ°´æ»´ç‹€ (ä¸Šå°–ä¸‹åœ“)</option>
            </select>
        </div>
        <div class="row">
            <label>æœ€å¤§ç›´å¾‘ (cm):</label>
            <input type="number" id="diameter" value="5" step="0.1">
        </div>
        <div class="row">
            <label>ç¸½é•·åº¦ (cm):</label>
            <input type="number" id="length" value="5" step="0.1">
        </div>
        <div class="checkbox-row">
            <input type="checkbox" id="keepOpen" onchange="document.getElementById('stopGroup').style.display = this.checked ? 'flex' : 'none'">
            <label for="keepOpen">ä¿ç•™ç¸«åˆå£ (ä¸å®Œå…¨æ”¶å®Œ)</label>
        </div>
        <div id="stopGroup" class="row" style="display:none;">
            <label>åœæ­¢æ–¼å¹¾é‡:</label>
            <select id="stopStitches">
                <option value="12" selected>12 é‡ (æ¨è–¦)</option>
                <option value="18">18 é‡</option>
                <option value="24">24 é‡</option>
            </select>
        </div>
        <button class="btn-generate" onclick="generate()">ç”Ÿæˆç¹”åœ–æ¸…å–®</button>
    </div>

    <div id="result"></div>
</div>

<script>
function copyP() {
    navigator.clipboard.writeText(document.getElementById('pBox').innerText);
    alert('å·²è¤‡è£½ï¼è«‹è²¼çµ¦ Gemini é€²è¡Œåˆ†æã€‚');
}

function generate() {
    const shape = document.getElementById('shape').value;
    const D = parseFloat(document.getElementById('diameter').value);
    let L = parseFloat(document.getElementById('length').value);
    const keepOpen = document.getElementById('keepOpen').checked;
    const stopSt = parseInt(document.getElementById('stopStitches').value);
    
    if (isNaN(D) || D <= 0) return;
    if (isNaN(L)) L = D;

    const N = Math.round(D); 
    const maxSt = N * 6;
    let html = `<table><tr><th>åœˆæ•¸</th><th>é‡æ³•é‚è¼¯</th><th>ç¸½é‡æ•¸</th></tr>`;
    let curr = 1;

    // åŠ é‡
    html += `<tr><td>1</td><td>MR (6X)</td><td>6</td></tr>`;
    if (N >= 2) html += `<tr><td>2</td><td>6V</td><td>12</td></tr>`, curr = 2;
    for (let i = 3; i <= N; i++) html += `<tr><td>${++curr}</td><td>(${i-2}X, V) * 6</td><td>${i * 6}</td></tr>`;

    // å›ºå®šå±¤
    let mid = (shape === 'normal') ? (L === D ? Math.round(N * 0.8) : Math.round((L - D) * 2.2)) : 1;
    for(let i=0; i<Math.max(1, mid); i++) html += `<tr><td>${++curr}</td><td>${maxSt}X</td><td>${maxSt}</td></tr>`;

    // æ¸›é‡
    if (shape === 'normal') {
        for (let i = N; i >= 2; i--) {
            let nextSt = (i - 1) * 6;
            if (keepOpen && (i * 6) === stopSt) break;
            html += `<tr><td>${++curr}</td><td>${i === 2 ? '6A' : `(${i-2}X, A) * 6`}</td><td>${nextSt}</td></tr>`;
            if (keepOpen && nextSt === stopSt) break;
        }
    } else {
        let curS = maxSt;
        while (curS > 6) {
            if (keepOpen && curS === stopSt) break;
            if (curr % 2 === 0) {
                let k = curS / 6;
                html += `<tr><td>${++curr}</td><td>(${k-2}X, A) * 6</td><td>${curS - 6}</td></tr>`;
                curS -= 6;
            } else {
                html += `<tr><td>${++curr}</td><td>${curS}X</td><td>${curS}</td></tr>`;
            }
            if (keepOpen && curS === stopSt) break;
            if (curr > 100) break;
        }
    }

    let note = keepOpen ? `<div class="notice">ğŸ’¡ <b>ç¸«åˆæé†’ï¼š</b>è«‹ä¿ç•™é•·ç·šé ­ä»¥ä¾¿èˆ‡å…¶ä»–éƒ¨ä½ç¸«åˆã€‚</div>` : "";
    document.getElementById('result').innerHTML = html + `</table>` + note;
}
</script>
</body>
</html>